<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="JavaScript," />





  <link rel="alternate" href="/atom.xml" title="但行好事，莫问前程" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="1. 简介简介部分的内容大部分摘自 Vue.js中文网，因为我觉得官网的介绍十分精简，可以跳过以下的简介部分直接去官网查看。 1.1 开发插件vue-plugin 属于 Vue 的插件范畴，通常会为 Vue  添加全局功能。插件的开发方式官网上提出一般为以下几种:  添加全局方法或者属性，如: vue-element 添加全局资源：指令/过滤器/过渡等，如 vue-touch 通过全局 mixin">
<meta name="keywords" content="JavaScript">
<meta property="og:type" content="article">
<meta property="og:title" content="vue-plugin 学习笔记">
<meta property="og:url" content="http://yoursite.com/2017/07/18/vue-plugin/index.html">
<meta property="og:site_name" content="但行好事，莫问前程">
<meta property="og:description" content="1. 简介简介部分的内容大部分摘自 Vue.js中文网，因为我觉得官网的介绍十分精简，可以跳过以下的简介部分直接去官网查看。 1.1 开发插件vue-plugin 属于 Vue 的插件范畴，通常会为 Vue  添加全局功能。插件的开发方式官网上提出一般为以下几种:  添加全局方法或者属性，如: vue-element 添加全局资源：指令/过滤器/过渡等，如 vue-touch 通过全局 mixin">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://silencewanghui.github.io/images/WX.jpg">
<meta property="og:updated_time" content="2017-08-14T02:10:18.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="vue-plugin 学习笔记">
<meta name="twitter:description" content="1. 简介简介部分的内容大部分摘自 Vue.js中文网，因为我觉得官网的介绍十分精简，可以跳过以下的简介部分直接去官网查看。 1.1 开发插件vue-plugin 属于 Vue 的插件范畴，通常会为 Vue  添加全局功能。插件的开发方式官网上提出一般为以下几种:  添加全局方法或者属性，如: vue-element 添加全局资源：指令/过滤器/过渡等，如 vue-touch 通过全局 mixin">
<meta name="twitter:image" content="https://silencewanghui.github.io/images/WX.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/07/18/vue-plugin/"/>





  <title>vue-plugin 学习笔记 | 但行好事，莫问前程</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">但行好事，莫问前程</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Web Developer</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/18/vue-plugin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="silence_wh">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="但行好事，莫问前程">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">vue-plugin 学习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-18T19:57:23+08:00">
                2017-07-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>简介部分的内容大部分摘自 <a href="https://cn.vuejs.org/v2/guide/plugins.html" target="_blank" rel="noopener">Vue.js中文网</a>，因为我觉得官网的介绍十分精简，可以跳过以下的简介部分直接去官网查看。</p>
<h3 id="1-1-开发插件"><a href="#1-1-开发插件" class="headerlink" title="1.1 开发插件"></a>1.1 开发插件</h3><p>vue-plugin 属于 Vue 的插件范畴，通常会为 Vue  添加全局功能。插件的开发方式官网上提出一般为以下几种:</p>
<ol>
<li>添加全局方法或者属性，如: <a href="https://github.com/karol-f/vue-custom-element" target="_blank" rel="noopener">vue-element</a></li>
<li>添加全局资源：指令/过滤器/过渡等，如 <a href="https://github.com/vuejs/vue-touch" target="_blank" rel="noopener">vue-touch</a></li>
<li>通过全局 mixin方法添加一些组件选项，如: <a href="https://github.com/vuejs/vuex" target="_blank" rel="noopener">vuex</a></li>
<li>添加 Vue 实例方法，通过把它们添加到 Vue.prototype 上实现。</li>
<li>一个库，提供自己的 API，同时提供上面提到的一个或多个功能，如 <a href="https://github.com/vuejs/vue-router" target="_blank" rel="noopener">vue-router</a></li>
</ol>
<p>在插件的实现方面，Vue.js 的插件应当有一个公开方法 install ，该方法的第一个参数是 Vue 构造器，第二个参数是一个可选的选项对象（官方示例）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">MyPlugin.install = <span class="function"><span class="keyword">function</span> (<span class="params">Vue, options</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. 添加全局方法或属性</span></span><br><span class="line">  Vue.myGlobalMethod = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 逻辑...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. 添加全局资源</span></span><br><span class="line">  Vue.directive(<span class="string">'my-directive'</span>, &#123;</span><br><span class="line">    bind (el, binding, vnode, oldVnode) &#123;</span><br><span class="line">      <span class="comment">// 逻辑...</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. 注入组件</span></span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 逻辑...</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4. 添加实例方法</span></span><br><span class="line">  Vue.prototype.$myMethod = <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 逻辑...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-2-使用插件"><a href="#1-2-使用插件" class="headerlink" title="1.2 使用插件"></a>1.2 使用插件</h3><p>首先需要通过 npm 将所需要的插件源码下载到项目的 node_modules 文件夹内，再通过 require 或者是 import 的方式引入该插件。最后通过 Vue.use() 使用插件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用 `MyPlugin.install(Vue)`</span></span><br><span class="line">Vue.use(MyPlugin)</span><br></pre></td></tr></table></figure>
<p>也可以传入一个选项对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.use(MyPlugin, &#123; <span class="attr">someOption</span>: <span class="literal">true</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>Vue.use 会自动阻止注册相同插件多次，届时只会注册一次该插件。</p>
<p>刚刚所说的使用插件的方式是在模块环境中，如果你是在页面中直接通过<script></script>引入插件的源码的，并且 Vue 是全局变量的情况下，一些插件（如 vue-router ）是会自动调用 Vue.use() 的。</p>
<h2 id="2-插件实例"><a href="#2-插件实例" class="headerlink" title="2. 插件实例"></a>2. 插件实例</h2><h3 id="2-1-vue-custom-element"><a href="#2-1-vue-custom-element" class="headerlink" title="2.1 vue-custom-element"></a>2.1 vue-custom-element</h3><p>GitHub 地址：<a href="https://github.com/karol-f/vue-custom-element" target="_blank" rel="noopener">https://github.com/karol-f/vue-custom-element</a></p>
<p>vue-custom-element 是通过在 Vue 上添加全局方法，以此让我们可以使用自定义的标签。</p>
<h6 id="Custom-Element-HTML"><a href="#Custom-Element-HTML" class="headerlink" title="Custom Element HTML"></a>Custom Element HTML</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; &lt;widget-vue prop1=&quot;1&quot; prop2=&quot;string&quot; prop3=&quot;true&quot;&gt;&lt;/widget-vue&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h6 id="JavaScript-register-with-Vue-custom-element"><a href="#JavaScript-register-with-Vue-custom-element" class="headerlink" title="JavaScript - register with Vue-custom-element"></a>JavaScript - register with Vue-custom-element</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; Vue.customElement(&apos;widget-vue&apos;, &#123;</span><br><span class="line">&gt;   props: [</span><br><span class="line">&gt;     &apos;prop1&apos;,</span><br><span class="line">&gt;     &apos;prop2&apos;,</span><br><span class="line">&gt;     &apos;prop3&apos;</span><br><span class="line">&gt;   ],</span><br><span class="line">&gt;   data: &#123;</span><br><span class="line">&gt;     message: &apos;Hello Vue!&apos;</span><br><span class="line">&gt;   &#125;,</span><br><span class="line">&gt;   template: &apos;&lt;p&gt;&#123;&#123; message &#125;&#125;, &#123;&#123; prop1  &#125;&#125;, &#123;&#123;prop2&#125;&#125;, &#123;&#123;prop3&#125;&#125;&lt;/p&gt;&apos;</span><br><span class="line">&gt; &#125;);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h6 id="JavaScript-element-API-usage"><a href="#JavaScript-element-API-usage" class="headerlink" title="JavaScript - element API usage"></a>JavaScript - element API usage</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; document.querySelector(&apos;widget-vue&apos;)[0].prop2 // get prop value</span><br><span class="line">&gt; document.querySelector(&apos;widget-vue&apos;)[0].prop2 = &apos;another string&apos; // set prop value</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>You can also change <code>&lt;widget-vue&gt;</code> HTML attributes and changes will be instantly reflected.</p>
</blockquote>
<p>上面是引用自 vue-custom-element 的 GitHub 上面的 README。</p>
<p>再看一下 vue-custom-element 中的一些代码片段：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> registerCustomElement <span class="keyword">from</span> <span class="string">'./utils/registerCustomElement'</span>;</span><br><span class="line"><span class="keyword">import</span> createVueInstance <span class="keyword">from</span> <span class="string">'./utils/createVueInstance'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getProps, convertAttributeValue &#125; <span class="keyword">from</span> <span class="string">'./utils/props'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; camelize &#125; <span class="keyword">from</span> <span class="string">'./utils/helpers'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">  Vue.customElement = <span class="function"><span class="keyword">function</span> <span class="title">vueCustomElement</span>(<span class="params">tag, componentDefinition, options = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> isAsyncComponent = <span class="keyword">typeof</span> componentDefinition === <span class="string">'function'</span>;</span><br><span class="line">    <span class="keyword">const</span> optionsProps = isAsyncComponent &amp;&amp; &#123; <span class="attr">props</span>: options.props || [] &#125;;</span><br><span class="line">    <span class="keyword">const</span> props = getProps(isAsyncComponent ? optionsProps : componentDefinition);</span><br><span class="line">    <span class="comment">// register Custom Element</span></span><br><span class="line">    <span class="keyword">const</span> CustomElement = registerCustomElement(tag, &#123;</span><br><span class="line">      constructorCallback() &#123;</span><br><span class="line">        <span class="keyword">typeof</span> options.constructorCallback === <span class="string">'function'</span> &amp;&amp; options.constructorCallback.call(<span class="keyword">this</span>);</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      connectedCallback() &#123;</span><br><span class="line">        <span class="keyword">const</span> asyncComponentPromise = isAsyncComponent &amp;&amp; componentDefinition();</span><br><span class="line">        <span class="keyword">const</span> isAsyncComponentPromise = asyncComponentPromise &amp;&amp; asyncComponentPromise.then &amp;&amp; <span class="keyword">typeof</span> asyncComponentPromise.then === <span class="string">'function'</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isAsyncComponent &amp;&amp; !isAsyncComponentPromise) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`Async component <span class="subst">$&#123;tag&#125;</span> do not returns Promise`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.__detached__) &#123;</span><br><span class="line">          <span class="keyword">if</span> (isAsyncComponentPromise) &#123;</span><br><span class="line">            asyncComponentPromise.then(<span class="function">(<span class="params">lazyLoadedComponent</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">const</span> lazyLoadedComponentProps = getProps(lazyLoadedComponent);</span><br><span class="line">              createVueInstance(<span class="keyword">this</span>, Vue, lazyLoadedComponent, lazyLoadedComponentProps, options);</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            createVueInstance(<span class="keyword">this</span>, Vue, componentDefinition, props, options);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.__detached__ = <span class="literal">false</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">      </span><br><span class="line">......</span><br><span class="line">      </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> install;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">window</span>.Vue) &#123;</span><br><span class="line">  <span class="built_in">window</span>.Vue.use(install);</span><br><span class="line">  <span class="keyword">if</span> (install.installed) &#123;</span><br><span class="line">    install.installed = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到 vue-custom-element 在 Vue 上添加了一个 customElement 的全局方法，并且暴露了 install 方法接收 Vue 的构造器。最后通过检查是否存在 Vue 全局变量，来调用 Vue.use() 实现插件的注册。</p>
<h3 id="2-2-vue-touch"><a href="#2-2-vue-touch" class="headerlink" title="2.2 vue-touch"></a>2.2 vue-touch</h3><p>GitHub 地址：<a href="https://github.com/vuejs/vue-touch" target="_blank" rel="noopener">https://github.com/vuejs/vue-touch</a></p>
<p>vue-touch 是一个在 Vue 项目中使用的对于 touch 事件处理的库，它是基于 Hammer.js 2.0 。</p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h4 id="Using-the-v-touch-directive"><a href="#Using-the-v-touch-directive" class="headerlink" title="Using the v-touch directive"></a>Using the <code>v-touch</code> directive</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; &lt;a v-touch:tap=&quot;onTap&quot;&gt;Tap me!&lt;/a&gt;</span><br><span class="line">&gt;</span><br><span class="line">&gt; &lt;div v-touch:swipeleft=&quot;onSwipeLeft&quot;&gt;Swipe me!&lt;/div&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="Configuring-Recognizer-Options"><a href="#Configuring-Recognizer-Options" class="headerlink" title="Configuring Recognizer Options"></a>Configuring Recognizer Options</h4><blockquote>
<p>There are two ways to customize recognizer options such as <code>direction</code> and <code>threshold</code>. The first one is setting global options:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; // change the threshold for all swipe recognizers</span><br><span class="line">&gt; VueTouch.config.swipe = &#123;</span><br><span class="line">&gt;   threshold: 200</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p>Or, you can use the <code>v-touch-options</code> directive to configure the behavior on a specific element:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; &lt;!-- detect only horizontal pans with a threshold of 100 --&gt;</span><br><span class="line">&gt; &lt;a</span><br><span class="line">&gt;   v-touch:pan=&quot;onPan&quot;</span><br><span class="line">&gt;   v-touch-options:pan=&quot;&#123; direction: &apos;horizontal&apos;, threshold: 100 &#125;&quot;&gt;</span><br><span class="line">&gt; &lt;/a&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="Registering-Custom-Events"><a href="#Registering-Custom-Events" class="headerlink" title="Registering Custom Events"></a>Registering Custom Events</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; // example registering a custom doubletap event.</span><br><span class="line">&gt; // the `type` indicates the base recognizer to use from Hammer</span><br><span class="line">&gt; // all other options are Hammer recognizer options.</span><br><span class="line">&gt; VueTouch.registerCustomEvent(&apos;doubletap&apos;, &#123;</span><br><span class="line">&gt;   type: &apos;tap&apos;,</span><br><span class="line">&gt;   taps: 2</span><br><span class="line">&gt; &#125;)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; &lt;a v-touch:doubletap=&quot;onDoubleTap&quot;&gt;&lt;/a&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>See <a href="http://hammerjs.github.io/getting-started/" target="_blank" rel="noopener">Hammer.js documentation</a> for all available events.<br>See <code>/example</code> for a multi-event demo. To build it, run <code>npm install &amp;&amp; npm run build</code>.</p>
</blockquote>
<p>上面是引用自 vue-touch 的 README.</p>
<p>下面是一些代码片段：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">vueTouch.install = <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    Vue.directive(<span class="string">'touch'</span>, &#123;</span><br><span class="line"></span><br><span class="line">      isFn: <span class="literal">true</span>,</span><br><span class="line">      acceptStatement: <span class="literal">true</span>,</span><br><span class="line">      priority: Vue.directive(<span class="string">'on'</span>).priority,</span><br><span class="line"></span><br><span class="line">      bind: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.el.hammer) &#123;</span><br><span class="line">          <span class="keyword">this</span>.el.hammer = <span class="keyword">new</span> Hammer.Manager(<span class="keyword">this</span>.el)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> mc = <span class="keyword">this</span>.mc = <span class="keyword">this</span>.el.hammer</span><br><span class="line">        <span class="comment">// determine event type</span></span><br><span class="line">        <span class="keyword">var</span> event = <span class="keyword">this</span>.arg</span><br><span class="line">        <span class="keyword">if</span> (!event) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">'[vue-touch] event type argument is required.'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> recognizerType, recognizer</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (customEvents[event]) &#123;</span><br><span class="line">          <span class="comment">// custom event</span></span><br><span class="line">          <span class="keyword">var</span> custom = customEvents[event]</span><br><span class="line">          recognizerType = custom.type</span><br><span class="line">          recognizer = <span class="keyword">new</span> Hammer[capitalize(recognizerType)](custom)</span><br><span class="line">          recognizer.recognizeWith(mc.recognizers)</span><br><span class="line">          mc.add(recognizer)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// built-in event</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; gestures.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (event.indexOf(gestures[i]) === <span class="number">0</span>) &#123;</span><br><span class="line">              recognizerType = gestures[i]</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (!recognizerType) &#123;</span><br><span class="line">            <span class="built_in">console</span>.warn(<span class="string">'[vue-touch] invalid event type: '</span> + event)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">          &#125;</span><br><span class="line">          recognizer = mc.get(recognizerType)</span><br><span class="line">          <span class="keyword">if</span> (!recognizer) &#123;</span><br><span class="line">            <span class="comment">// add recognizer</span></span><br><span class="line">            recognizer = <span class="keyword">new</span> Hammer[capitalize(recognizerType)]()</span><br><span class="line">            <span class="comment">// make sure multiple recognizers work together...</span></span><br><span class="line">            recognizer.recognizeWith(mc.recognizers)</span><br><span class="line">            mc.add(recognizer)</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// apply global options</span></span><br><span class="line">          <span class="keyword">var</span> globalOptions = vueTouch.config[recognizerType]</span><br><span class="line">          <span class="keyword">if</span> (globalOptions) &#123;</span><br><span class="line">            guardDirections(globalOptions)</span><br><span class="line">            recognizer.set(globalOptions)</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// apply local options</span></span><br><span class="line">          <span class="keyword">var</span> localOptions =</span><br><span class="line">            <span class="keyword">this</span>.el.hammerOptions &amp;&amp;</span><br><span class="line">            <span class="keyword">this</span>.el.hammerOptions[recognizerType]</span><br><span class="line">          <span class="keyword">if</span> (localOptions) &#123;</span><br><span class="line">            guardDirections(localOptions)</span><br><span class="line">            recognizer.set(localOptions)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.recognizer = recognizer</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      update: <span class="function"><span class="keyword">function</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> mc = <span class="keyword">this</span>.mc</span><br><span class="line">        <span class="keyword">var</span> event = <span class="keyword">this</span>.arg</span><br><span class="line">        <span class="comment">// teardown old handler</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.handler) &#123;</span><br><span class="line">          mc.off(event, <span class="keyword">this</span>.handler)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> fn !== <span class="string">'function'</span>) &#123;</span><br><span class="line">          <span class="keyword">this</span>.handler = <span class="literal">null</span></span><br><span class="line">          <span class="built_in">console</span>.warn(</span><br><span class="line">            <span class="string">'[vue-touch] invalid handler function for v-touch: '</span> +</span><br><span class="line">            <span class="keyword">this</span>.arg + <span class="string">'="'</span> + <span class="keyword">this</span>.descriptor.raw</span><br><span class="line">          )</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          mc.on(event, (<span class="keyword">this</span>.handler = fn))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      unbind: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.handler) &#123;</span><br><span class="line">          <span class="keyword">this</span>.mc.off(<span class="keyword">this</span>.arg, <span class="keyword">this</span>.handler)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">Object</span>.keys(<span class="keyword">this</span>.mc.handlers).length) &#123;</span><br><span class="line">          <span class="keyword">this</span>.mc.destroy()</span><br><span class="line">          <span class="keyword">this</span>.el.hammer = <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    Vue.directive(<span class="string">'touch-options'</span>, &#123;</span><br><span class="line">      priority: Vue.directive(<span class="string">'on'</span>).priority + <span class="number">1</span>,</span><br><span class="line">      update: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> opts = <span class="keyword">this</span>.el.hammerOptions || (<span class="keyword">this</span>.el.hammerOptions = &#123;&#125;)</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.arg) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">'[vue-touch] recognizer type argument for v-touch-options is required.'</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          opts[<span class="keyword">this</span>.arg] = options</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>其中用到了 Vue 中关于自定义指令的部分。自定义指令主要是在我们需要对 DOM 进行一些直接操作时所用的方法，指令定义函数提供了几个钩子函数（可选）：</p>
<ul>
<li><code>bind</code>: 只调用一次，指令第一次绑定到元素时调用，用这个钩子函数可以定义一个在绑定时执行一次的初始化动作。</li>
<li><code>inserted</code>: 被绑定元素插入父节点时调用（父节点存在即可调用，不必存在于 document 中）。</li>
<li><code>update</code>: 被绑定元素所在的模板更新时调用，而不论绑定值是否变化。通过比较更新前后的绑定值，可以忽略不必要的模板更新（详细的钩子函数参数见下）。</li>
<li><code>componentUpdated</code>: 被绑定元素所在模板完成一次更新周期时调用。</li>
<li><code>unbind</code>: 只调用一次， 指令与元素解绑时调用。</li>
</ul>
<p>这些钩子函数会被传入一些参数，以便我们对所绑定元素进行一些 DOM 操作和 对虚拟节点的一些数据操作。详细的参数如下：</p>
<ul>
<li><p><strong>el</strong>: 指令所绑定的元素，可以用来直接操作 DOM 。</p>
</li>
<li><p>binding</p>
<p>: 一个对象，包含以下属性：</p>
<ul>
<li><strong>name</strong>: 指令名，不包括 <code>v-</code> 前缀。</li>
<li><strong>value</strong>: 指令的绑定值， 例如： <code>v-my-directive=&quot;1 + 1&quot;</code>, value 的值是 <code>2</code>。</li>
<li><strong>oldValue</strong>: 指令绑定的前一个值，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。无论值是否改变都可用。</li>
<li><strong>expression</strong>: 绑定值的字符串形式。 例如 <code>v-my-directive=&quot;1 + 1&quot;</code> ， expression 的值是 <code>&quot;1 + 1&quot;</code>。</li>
<li><strong>arg</strong>: 传给指令的参数。例如 <code>v-my-directive:foo</code>， arg 的值是 <code>&quot;foo&quot;</code>。</li>
<li><strong>modifiers</strong>: 一个包含修饰符的对象。 例如： <code>v-my-directive.foo.bar</code>, 修饰符对象 modifiers 的值是 <code>{ foo: true, bar: true }</code>。</li>
</ul>
</li>
<li><p><strong>vnode</strong>: Vue 编译生成的虚拟节点，查阅 <a href="https://cn.vuejs.org/v2/api/#VNode接口" target="_blank" rel="noopener">VNode API</a> 了解更多详情。</p>
</li>
<li><p><strong>oldVnode</strong>: 上一个虚拟节点，仅在 <code>update</code> 和 <code>componentUpdated</code> 钩子中可用。</p>
</li>
</ul>
<h3 id="2-3-vuex"><a href="#2-3-vuex" class="headerlink" title="2.3 vuex"></a>2.3 vuex</h3><p>GitHub 地址：<a href="https://github.com/vuejs/vuex" target="_blank" rel="noopener">https://github.com/vuejs/vuex</a></p>
<p>vuex 为 Vue.js 应用提供了一个集中式状态管理的解决方案，几乎是大中型 Vue 应用的必备解决方案。它采用的是通过全局 mixin 方法添加一些组件选项。以下是截取的一个源码片段：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> version = <span class="built_in">Number</span>(Vue.version.split(<span class="string">'.'</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (version &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">    Vue.mixin(&#123; <span class="attr">beforeCreate</span>: vuexInit &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// override init and inject vuex init procedure</span></span><br><span class="line">    <span class="comment">// for 1.x backwards compatibility.</span></span><br><span class="line">    <span class="keyword">const</span> _init = Vue.prototype._init</span><br><span class="line">    Vue.prototype._init = <span class="function"><span class="keyword">function</span> (<span class="params">options = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">      options.init = options.init</span><br><span class="line">        ? [vuexInit].concat(options.init)</span><br><span class="line">        : vuexInit</span><br><span class="line">      _init.call(<span class="keyword">this</span>, options)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Vuex init hook, injected into each instances init hooks list.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">vuexInit</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> options = <span class="keyword">this</span>.$options</span><br><span class="line">    <span class="comment">// store injection</span></span><br><span class="line">    <span class="keyword">if</span> (options.store) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$store = <span class="keyword">typeof</span> options.store === <span class="string">'function'</span></span><br><span class="line">        ? options.store()</span><br><span class="line">        : options.store</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.parent &amp;&amp; options.parent.$store) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$store = options.parent.$store</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中用到了 Vue 插件的一种实现方式：<a href="https://cn.vuejs.org/v2/guide/mixins.html" target="_blank" rel="noopener">mixin（混合）</a></p>
<blockquote>
<p>混合是一种灵活的分布式复用 Vue 组件的方式。混合对象可以包含任意组件选项。以组件使用混合对象时，所有混合对象的选项将被混入该组件本身的选项。</p>
</blockquote>
<p>官网的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个混合对象</span></span><br><span class="line"><span class="keyword">var</span> myMixin = &#123;</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.hello()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    hello: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'hello from mixin!'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个使用混合对象的组件</span></span><br><span class="line"><span class="keyword">var</span> Component = Vue.extend(&#123;</span><br><span class="line">  mixins: [myMixin]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> component = <span class="keyword">new</span> Component() <span class="comment">// -&gt; "hello from mixin!"</span></span><br></pre></td></tr></table></figure>
<p>从某种层面上来讲，混合可以理解成是组件的代码片段，它和组件进行混用的时候有一些特殊的合并规则。</p>
<h4 id="2-3-1-选项合并"><a href="#2-3-1-选项合并" class="headerlink" title="2.3.1 选项合并"></a>2.3.1 选项合并</h4><blockquote>
<p>当组件和混合对象含有同名选项时，这些选项将以恰当的方式混合。比如，同名钩子函数将混合为一个数组，因此都将被调用。另外，混合对象的 钩子将在组件自身钩子 <strong>之前</strong> 调用 。</p>
</blockquote>
<p>官网的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mixin = &#123;</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'混合对象的钩子被调用'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  mixins: [mixin],</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'组件钩子被调用'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// -&gt; "混合对象的钩子被调用"</span></span><br><span class="line"><span class="comment">// -&gt; "组件钩子被调用"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>值为对象的选项，例如 <code>methods</code>, <code>components</code> 和 <code>directives</code>，将被混合为同一个对象。 两个对象键名冲突时，取组件对象的键值对。</p>
</blockquote>
<p>官网的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mixin = &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    foo: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    conflicting: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'from mixin'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  mixins: [mixin],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    bar: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'bar'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    conflicting: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'from self'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">vm.foo() <span class="comment">// -&gt; "foo"</span></span><br><span class="line">vm.bar() <span class="comment">// -&gt; "bar"</span></span><br><span class="line">vm.conflicting() <span class="comment">// -&gt; "from self"</span></span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-全局混合"><a href="#2-3-2-全局混合" class="headerlink" title="2.3.2 全局混合"></a>2.3.2 全局混合</h4><blockquote>
<p>也可以全局注册混合对象。 注意使用！ 一旦使用全局混合对象，将会影响到 <strong>所有</strong> 之后创建的 Vue 实例。使用恰当时，可以为自定义对象注入处理逻辑。</p>
</blockquote>
<p>官网的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为自定义的选项 'myOption' 注入一个处理器。 </span></span><br><span class="line">Vue.mixin(&#123;</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> myOption = <span class="keyword">this</span>.$options.myOption</span><br><span class="line">    <span class="keyword">if</span> (myOption) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(myOption)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  myOption: <span class="string">'hello!'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// -&gt; "hello!"</span></span><br></pre></td></tr></table></figure>
<h4 id="2-3-3-自定义混合策略"><a href="#2-3-3-自定义混合策略" class="headerlink" title="2.3.3 自定义混合策略"></a>2.3.3 自定义混合策略</h4><p>这种混合方式不是很明白，以下是官方文档：</p>
<blockquote>
<p>自定义选项混合策略<br>自定义选项将使用默认策略，即简单地覆盖已有值。 如果想让自定义选项以自定义逻辑混合，可以向 <code>Vue.config.optionMergeStrategies</code> 添加一个函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Vue.config.optionMergeStrategies.myOption = function (toVal, fromVal) &#123;</span><br><span class="line">&gt;   // return mergedVal</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p>对于大多数对象选项，可以使用 <code>methods</code> 的合并策略:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; var strategies = Vue.config.optionMergeStrategies</span><br><span class="line">&gt; strategies.myOption = strategies.methods</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p>更多高级的例子可以在 <a href="https://github.com/vuejs/vuex" target="_blank" rel="noopener">Vuex</a> 1.x的混合策略里找到:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; const merge = Vue.config.optionMergeStrategies.computed</span><br><span class="line">&gt; Vue.config.optionMergeStrategies.vuex = function (toVal, fromVal) &#123;</span><br><span class="line">&gt;   if (!toVal) return fromVal</span><br><span class="line">&gt;   if (!fromVal) return toVal</span><br><span class="line">&gt;   return &#123;</span><br><span class="line">&gt;     getters: merge(toVal.getters, fromVal.getters),</span><br><span class="line">&gt;     state: merge(toVal.state, fromVal.state),</span><br><span class="line">&gt;     actions: merge(toVal.actions, fromVal.actions)</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>关于 mixin 的使用姿势，请阅读这篇文章：<a href="http://zcfy.cc/article/using-mixins-in-vue-js-css-tricks-3257.html?t=new" target="_blank" rel="noopener">在 Vue.js 中使用Mixin —— CSS-Tricks</a></p>
<h3 id="2-4-vue-router"><a href="#2-4-vue-router" class="headerlink" title="2.4 vue-router"></a>2.4 vue-router</h3><p>GitHub 地址：<a href="https://github.com/vuejs/vue-router" target="_blank" rel="noopener">https://github.com/vuejs/vue-router</a></p>
<p>vue-router 是 Vue 应用官方推荐的路由解决方案，与 Vue.js 结合去构建单页应用。</p>
<p>截取了一小段源码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">  Vue.mixin(&#123;</span><br><span class="line">    beforeCreate () &#123;</span><br><span class="line">      <span class="keyword">if</span> (isDef(<span class="keyword">this</span>.$options.router)) &#123;</span><br><span class="line">        <span class="keyword">this</span>._routerRoot = <span class="keyword">this</span></span><br><span class="line">        <span class="keyword">this</span>._router = <span class="keyword">this</span>.$options.router</span><br><span class="line">        <span class="keyword">this</span>._router.init(<span class="keyword">this</span>)</span><br><span class="line">        Vue.util.defineReactive(<span class="keyword">this</span>, <span class="string">'_route'</span>, <span class="keyword">this</span>._router.history.current)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>._routerRoot = (<span class="keyword">this</span>.$parent &amp;&amp; <span class="keyword">this</span>.$parent._routerRoot) || <span class="keyword">this</span></span><br><span class="line">      &#125;</span><br><span class="line">      registerInstance(<span class="keyword">this</span>, <span class="keyword">this</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    destroyed () &#123;</span><br><span class="line">      registerInstance(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(Vue.prototype, <span class="string">'$router'</span>, &#123;</span><br><span class="line">    get () &#123; <span class="keyword">return</span> <span class="keyword">this</span>._routerRoot._router &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(Vue.prototype, <span class="string">'$route'</span>, &#123;</span><br><span class="line">    get () &#123; <span class="keyword">return</span> <span class="keyword">this</span>._routerRoot._route &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  Vue.component(<span class="string">'router-view'</span>, View)</span><br><span class="line">  Vue.component(<span class="string">'router-link'</span>, Link)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> strats = Vue.config.optionMergeStrategies</span><br><span class="line">  <span class="comment">// use the same hook merging strategy for route hooks</span></span><br><span class="line">  strats.beforeRouteEnter = strats.beforeRouteLeave = strats.beforeRouteUpdate = strats.created</span><br></pre></td></tr></table></figure>
<p>可以看到 vue-rouer 在 Vue.prototype 上面添加了自定义的对象，这只是其中能够体现 vue-router 扩展插件的一小部分，vue-rouer 用到了文章上部分讲的开发插件的各种方式。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文主要是简单介绍了关于 Vue 插件的基本概念以及其实现的几种形式，内容大部分摘自 <a href="https://cn.vuejs.org/v2/guide/" target="_blank" rel="noopener">Vue.js 中文网</a>。</p>
<p>关于插件的理解，个人觉得主要是从实践中去进行理解，因此，本文主要是做概念上的简单介绍。<br>学习时写了个很小的 <a href="https://github.com/Silencewanghui/vue-plugin-demo" target="_blank" rel="noopener">demo</a> 作为练习。</p>
<p><img src="https://silencewanghui.github.io/images/WX.jpg" alt="微信赞赏"></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/19/防抖动、节流阀与rAF/" rel="next" title="防抖动、节流阀与rAF">
                <i class="fa fa-chevron-left"></i> 防抖动、节流阀与rAF
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/20/Node.js 项目服务端部署/" rel="prev" title="Node.js 项目服务端部署">
                Node.js 项目服务端部署 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="silence_wh" />
          <p class="site-author-name" itemprop="name">silence_wh</p>
           
              <p class="site-description motion-element" itemprop="description">代码还是要用心写的.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-简介"><span class="nav-number">1.</span> <span class="nav-text">1. 简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-开发插件"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 开发插件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-使用插件"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 使用插件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-插件实例"><span class="nav-number">2.</span> <span class="nav-text">2. 插件实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-vue-custom-element"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 vue-custom-element</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Custom-Element-HTML"><span class="nav-number">2.1.0.0.1.</span> <span class="nav-text">Custom Element HTML</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#JavaScript-register-with-Vue-custom-element"><span class="nav-number">2.1.0.0.2.</span> <span class="nav-text">JavaScript - register with Vue-custom-element</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#JavaScript-element-API-usage"><span class="nav-number">2.1.0.0.3.</span> <span class="nav-text">JavaScript - element API usage</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-vue-touch"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 vue-touch</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Usage"><span class="nav-number">3.</span> <span class="nav-text">Usage</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Using-the-v-touch-directive"><span class="nav-number">3.0.1.</span> <span class="nav-text">Using the v-touch directive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Configuring-Recognizer-Options"><span class="nav-number">3.0.2.</span> <span class="nav-text">Configuring Recognizer Options</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Registering-Custom-Events"><span class="nav-number">3.0.3.</span> <span class="nav-text">Registering Custom Events</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-vuex"><span class="nav-number">3.1.</span> <span class="nav-text">2.3 vuex</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-选项合并"><span class="nav-number">3.1.1.</span> <span class="nav-text">2.3.1 选项合并</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-全局混合"><span class="nav-number">3.1.2.</span> <span class="nav-text">2.3.2 全局混合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-自定义混合策略"><span class="nav-number">3.1.3.</span> <span class="nav-text">2.3.3 自定义混合策略</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-vue-router"><span class="nav-number">3.2.</span> <span class="nav-text">2.4 vue-router</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">4.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">silence_wh</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
